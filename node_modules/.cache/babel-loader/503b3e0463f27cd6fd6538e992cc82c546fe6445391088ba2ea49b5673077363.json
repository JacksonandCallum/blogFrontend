{"ast":null,"code":"import config from \"../../config/index\";\nimport loading from \"../../components/loading.vue\";\nexport default {\n  name: \"title-large\",\n  components: {\n    loading\n  },\n  props: {\n    content: {\n      default() {\n        return {};\n      }\n    },\n    token: {\n      default: \"\"\n    }\n  },\n  data() {\n    return {\n      file: null,\n      maxWidth: 0,\n      currentW: \"\",\n      tips: \"\",\n      src: \"\",\n      loadingState: 0 // 0不需要上传,1:上传中,2上传成功,3上传失败\n    };\n  },\n  async mounted() {\n    this.$nextTick(() => {\n      this.maxWidth = this.$refs.imgbox.clientWidth;\n    });\n  },\n  watch: {\n    token: {\n      immediate: true,\n      handler() {\n        this.$nextTick(() => {\n          this.tips = this.content.tips;\n          this.src = this.content.src;\n          this.currentW = this.content.src ? this.content.style.width : \"\";\n          this.onChange();\n        });\n      }\n    }\n  },\n  methods: {\n    onImage() {\n      // 初始化默认宽度\n      this.$nextTick(() => {\n        let imgW = this.$refs.img.width;\n        this.maxWidth = this.$refs.imgbox.clientWidth;\n        let w = (imgW / this.maxWidth).toFixed(1);\n        w = w * 100;\n        w = w <= 20 ? 20 : w;\n        w = w >= 100 ? 100 : w;\n        this.currentW = w;\n      });\n      this.onChange();\n    },\n    // 放大\n    amplify() {\n      let w = this.currentW;\n      w += 5;\n      w = w >= 100 ? 100 : w;\n      this.currentW = w;\n      this.onChange();\n    },\n    // 缩小\n    reduceImg() {\n      let w = this.currentW;\n      w -= 5;\n      w = w <= 20 ? 20 : w;\n      this.currentW = w;\n      this.onChange();\n    },\n    onChange() {\n      this.$emit(\"change\", {\n        src: this.src,\n        tips: this.tips,\n        style: {\n          width: this.currentW\n        }\n      });\n    },\n    // 选择图片\n    onSelectImg(data) {\n      if (data.target.files.length <= 0) return;\n      let files = [...data.target.files];\n      this.file = files[0];\n      this.uploadImg();\n    },\n    uploadImg() {\n      let file = this.file;\n      var reader = new FileReader();\n      reader.readAsDataURL(this.file);\n      //监听文件读取结束后事件\n      let that = this;\n      reader.onloadend = async function (e) {\n        that.loadingState = 0;\n        that.src = reader.result;\n        if (config.uploadImg) {\n          that.loadingState = 1;\n          let [err, data] = await config.uploadImg(file);\n          if (err) {\n            that.loadingState = 3;\n          } else {\n            that.loadingState = 2;\n            that.src = data;\n          }\n        }\n        that.onChange();\n      };\n    },\n    // 删除图片\n    deleteImg() {\n      this.loadingState = 0;\n      this.src = \"\";\n      this.file = \"\";\n      this.currentW = \"\";\n      this.onChange();\n    }\n  }\n};","map":{"version":3,"names":["config","loading","name","components","props","content","default","token","data","file","maxWidth","currentW","tips","src","loadingState","mounted","$nextTick","$refs","imgbox","clientWidth","watch","immediate","handler","style","width","onChange","methods","onImage","imgW","img","w","toFixed","amplify","reduceImg","$emit","onSelectImg","target","files","length","uploadImg","reader","FileReader","readAsDataURL","that","onloadend","e","result","err","deleteImg"],"sources":["node_modules/vue2-lay-editor/temp/images/index.vue"],"sourcesContent":["<template>\n  <div ref=\"image\" class=\"image-one\">\n    <div ref=\"imgbox\" class=\"image-one-section\">\n      <div class=\"image-one-content\">\n        <div\n          v-if=\"src\"\n          class=\"image-item\"\n          :style=\"{\n            width: currentW + '%',\n          }\"\n        >\n          <img ref=\"img\" @load=\"onImage\" :src=\"src\" alt=\"\" />\n          <!-- 删除图片 -->\n          <div @click=\"deleteImg\" class=\"del\">\n            <img src=\"../../assets/del.png\" alt=\"\" />\n          </div>\n          <!-- 图片上传状态 -->\n          <div class=\"loading-state\" v-if=\"loadingState > 0\">\n            <loading v-if=\"loadingState == 1\"></loading>\n            <span v-if=\"loadingState == 2\">上传成功</span>\n            <span @click=\"uploadImg\" class=\"upload-err\" v-if=\"loadingState == 3\"\n              >上传失败,重新上传</span\n            >\n          </div>\n\n          <div class=\"control\">\n            <span @click=\"amplify\">放大</span>\n            <span @click=\"reduceImg\">缩小</span>\n          </div>\n        </div>\n        <div v-else class=\"select-image\">\n          <input\n            class=\"file\"\n            type=\"file\"\n            @change=\"onSelectImg\"\n            accept=\"image/*\"\n          />\n          点击选择图片\n        </div>\n      </div>\n      <div class=\"tips\">\n        <input\n          @input=\"onChange\"\n          v-model=\"tips\"\n          placeholder=\"图片描述信息\"\n          type=\"text\"\n        />\n      </div>\n      <div ref=\"aaa\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport config from \"../../config/index\";\nimport loading from \"../../components/loading.vue\";\nexport default {\n  name: \"title-large\",\n  components: {\n    loading,\n  },\n  props: {\n    content: {\n      default() {\n        return {};\n      },\n    },\n    token: {\n      default: \"\",\n    },\n  },\n  data() {\n    return {\n      file: null,\n      maxWidth: 0,\n      currentW: \"\",\n      tips: \"\",\n      src: \"\",\n      loadingState: 0, // 0不需要上传,1:上传中,2上传成功,3上传失败\n    };\n  },\n  async mounted() {\n    this.$nextTick(() => {\n      this.maxWidth = this.$refs.imgbox.clientWidth;\n    });\n  },\n  watch: {\n    token: {\n      immediate: true,\n      handler() {\n        this.$nextTick(() => {\n          this.tips = this.content.tips;\n          this.src = this.content.src;\n          this.currentW = this.content.src ? this.content.style.width : \"\";\n          this.onChange();\n        });\n      },\n    },\n  },\n  methods: {\n    onImage() {\n      // 初始化默认宽度\n      this.$nextTick(() => {\n        let imgW = this.$refs.img.width;\n        this.maxWidth = this.$refs.imgbox.clientWidth;\n        let w = (imgW / this.maxWidth).toFixed(1);\n        w = w * 100;\n        w = w <= 20 ? 20 : w;\n        w = w >= 100 ? 100 : w;\n        this.currentW = w;\n      });\n      this.onChange();\n    },\n    // 放大\n    amplify() {\n      let w = this.currentW;\n      w += 5;\n      w = w >= 100 ? 100 : w;\n      this.currentW = w;\n      this.onChange();\n    },\n    // 缩小\n    reduceImg() {\n      let w = this.currentW;\n      w -= 5;\n      w = w <= 20 ? 20 : w;\n      this.currentW = w;\n      this.onChange();\n    },\n    onChange() {\n      this.$emit(\"change\", {\n        src: this.src,\n        tips: this.tips,\n        style: {\n          width: this.currentW,\n        },\n      });\n    },\n    // 选择图片\n    onSelectImg(data) {\n      if (data.target.files.length <= 0) return;\n      let files = [...data.target.files];\n      this.file = files[0];\n      this.uploadImg();\n    },\n    uploadImg() {\n      let file = this.file;\n      var reader = new FileReader();\n      reader.readAsDataURL(this.file);\n      //监听文件读取结束后事件\n      let that = this;\n      reader.onloadend = async function (e) {\n        that.loadingState = 0;\n        that.src = reader.result;\n        if (config.uploadImg) {\n          that.loadingState = 1;\n          let [err, data] = await config.uploadImg(file);\n          if (err) {\n            that.loadingState = 3;\n          } else {\n            that.loadingState = 2;\n            that.src = data;\n          }\n        }\n        that.onChange();\n      };\n    },\n    // 删除图片\n    deleteImg() {\n      this.loadingState = 0;\n      this.src = \"\";\n      this.file = \"\";\n      this.currentW = \"\";\n      this.onChange();\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.image-one-section {\n  // background: #fff;\n}\n\n// 内容区域\n.image-one-section .image-one-content {\n  display: flex;\n  align-items: center;\n  padding: 15px 15px 0;\n  justify-content: center;\n}\n\n// 提示\n.image-one-section .tips {\n  text-align: center;\n  font-size: 14px;\n  color: #999;\n  padding: 5px 10px 20px;\n}\n.image-one-section .tips input {\n  color: #999;\n  text-align: center;\n  background: transparent;\n}\n\n.image-one-section .tips input::placeholder {\n  color: #ccc;\n}\n\n.image-one-content .image-item {\n  // width: 100%;\n  background: #f5f5f5;\n  display: flex;\n  position: relative;\n}\n.image-item .del {\n  width: 35px;\n  height: 35px;\n  position: absolute;\n  right: 10px;\n  top: 10px;\n  background: rgba(0, 0, 0, 0.5);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n.image-item .del img {\n  width: 70%;\n  height: 65%;\n}\n.image-item .loading-state {\n  min-width: 35px;\n  height: 35px;\n  position: absolute;\n  left: 50%;\n  top: 10px;\n  background: rgba(0, 0, 0, 0.5);\n  border-radius: 5px;\n  transform: translateX(-50%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  color: #fff;\n}\n.image-item .loading-state span {\n  padding: 0 10px;\n  font-size: 14px;\n}\n\n.image-item .upload-err {\n  color: rgb(245, 108, 108);\n  text-align: center;\n  padding: 2px 6px !important;\n}\n\n// 控制\n.image-one-content .image-item .control {\n  width: 100%;\n  padding: 0 10px;\n  display: none;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  box-sizing: border-box;\n  background: rgba(0, 0, 0, 0.5);\n  cursor: pointer;\n  user-select: none;\n}\n\n.image-one-content .image-item .control span {\n  flex: 1;\n  padding: 10px;\n  text-align: center;\n  color: #fff;\n}\n\n.image-one-content:hover .control {\n  display: flex;\n}\n\n// 上传图片\n.select-image {\n  width: 100%;\n  height: 200px;\n  text-align: center;\n  line-height: 200px;\n  position: relative;\n  color: #ccc;\n  background: #f5f5f5;\n}\n.select-image input {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n}\n\n.image-one-section .image-item .image-empty {\n  height: 200px;\n  width: 100%;\n  background: #f5f5f5;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n</style>\n"],"mappings":"AAsDA,OAAAA,MAAA;AACA,OAAAC,OAAA;AACA;EACAC,IAAA;EACAC,UAAA;IACAF;EACA;EACAG,KAAA;IACAC,OAAA;MACAC,QAAA;QACA;MACA;IACA;IACAC,KAAA;MACAD,OAAA;IACA;EACA;EACAE,KAAA;IACA;MACAC,IAAA;MACAC,QAAA;MACAC,QAAA;MACAC,IAAA;MACAC,GAAA;MACAC,YAAA;IACA;EACA;EACA,MAAAC,QAAA;IACA,KAAAC,SAAA;MACA,KAAAN,QAAA,QAAAO,KAAA,CAAAC,MAAA,CAAAC,WAAA;IACA;EACA;EACAC,KAAA;IACAb,KAAA;MACAc,SAAA;MACAC,QAAA;QACA,KAAAN,SAAA;UACA,KAAAJ,IAAA,QAAAP,OAAA,CAAAO,IAAA;UACA,KAAAC,GAAA,QAAAR,OAAA,CAAAQ,GAAA;UACA,KAAAF,QAAA,QAAAN,OAAA,CAAAQ,GAAA,QAAAR,OAAA,CAAAkB,KAAA,CAAAC,KAAA;UACA,KAAAC,QAAA;QACA;MACA;IACA;EACA;EACAC,OAAA;IACAC,QAAA;MACA;MACA,KAAAX,SAAA;QACA,IAAAY,IAAA,QAAAX,KAAA,CAAAY,GAAA,CAAAL,KAAA;QACA,KAAAd,QAAA,QAAAO,KAAA,CAAAC,MAAA,CAAAC,WAAA;QACA,IAAAW,CAAA,IAAAF,IAAA,QAAAlB,QAAA,EAAAqB,OAAA;QACAD,CAAA,GAAAA,CAAA;QACAA,CAAA,GAAAA,CAAA,cAAAA,CAAA;QACAA,CAAA,GAAAA,CAAA,gBAAAA,CAAA;QACA,KAAAnB,QAAA,GAAAmB,CAAA;MACA;MACA,KAAAL,QAAA;IACA;IACA;IACAO,QAAA;MACA,IAAAF,CAAA,QAAAnB,QAAA;MACAmB,CAAA;MACAA,CAAA,GAAAA,CAAA,gBAAAA,CAAA;MACA,KAAAnB,QAAA,GAAAmB,CAAA;MACA,KAAAL,QAAA;IACA;IACA;IACAQ,UAAA;MACA,IAAAH,CAAA,QAAAnB,QAAA;MACAmB,CAAA;MACAA,CAAA,GAAAA,CAAA,cAAAA,CAAA;MACA,KAAAnB,QAAA,GAAAmB,CAAA;MACA,KAAAL,QAAA;IACA;IACAA,SAAA;MACA,KAAAS,KAAA;QACArB,GAAA,OAAAA,GAAA;QACAD,IAAA,OAAAA,IAAA;QACAW,KAAA;UACAC,KAAA,OAAAb;QACA;MACA;IACA;IACA;IACAwB,YAAA3B,IAAA;MACA,IAAAA,IAAA,CAAA4B,MAAA,CAAAC,KAAA,CAAAC,MAAA;MACA,IAAAD,KAAA,OAAA7B,IAAA,CAAA4B,MAAA,CAAAC,KAAA;MACA,KAAA5B,IAAA,GAAA4B,KAAA;MACA,KAAAE,SAAA;IACA;IACAA,UAAA;MACA,IAAA9B,IAAA,QAAAA,IAAA;MACA,IAAA+B,MAAA,OAAAC,UAAA;MACAD,MAAA,CAAAE,aAAA,MAAAjC,IAAA;MACA;MACA,IAAAkC,IAAA;MACAH,MAAA,CAAAI,SAAA,mBAAAC,CAAA;QACAF,IAAA,CAAA7B,YAAA;QACA6B,IAAA,CAAA9B,GAAA,GAAA2B,MAAA,CAAAM,MAAA;QACA,IAAA9C,MAAA,CAAAuC,SAAA;UACAI,IAAA,CAAA7B,YAAA;UACA,KAAAiC,GAAA,EAAAvC,IAAA,UAAAR,MAAA,CAAAuC,SAAA,CAAA9B,IAAA;UACA,IAAAsC,GAAA;YACAJ,IAAA,CAAA7B,YAAA;UACA;YACA6B,IAAA,CAAA7B,YAAA;YACA6B,IAAA,CAAA9B,GAAA,GAAAL,IAAA;UACA;QACA;QACAmC,IAAA,CAAAlB,QAAA;MACA;IACA;IACA;IACAuB,UAAA;MACA,KAAAlC,YAAA;MACA,KAAAD,GAAA;MACA,KAAAJ,IAAA;MACA,KAAAE,QAAA;MACA,KAAAc,QAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}