{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: \"FrontLayout\",\n  data() {\n    return {\n      top: '',\n      notice: [],\n      user: JSON.parse(localStorage.getItem(\"xm-user\") || '{}'),\n      hoverEnter: false,\n      toolButton: false,\n      scrollTop: 0,\n      mobile: false\n    };\n  },\n  computed: {\n    toolbar() {\n      return this.$store.state.toolbar;\n    }\n  },\n  watch: {\n    scrollTop(scrollTop, oldScrollTop) {\n      //如果滑动距离超过屏幕高度三分之一视为进入页面，背景改为白色\n      let enter = scrollTop > window.innerHeight / 2;\n      const top = scrollTop - oldScrollTop < 0;\n      let isShow = scrollTop - window.innerHeight > 30;\n      this.toolButton = isShow;\n      if (isShow) {\n        if (window.innerHeight > 950) {\n          $(\".cd-top\").css(\"top\", \"0\");\n        } else {\n          $(\".cd-top\").css(\"top\", window.innerHeight - 950 + \"px\");\n        }\n      } else if (!isShow) {\n        $(\".cd-top\").css(\"top\", \"-900px\");\n      }\n\n      //导航栏显示与颜色\n      let toolbarStatus = {\n        enter: enter,\n        visible: top\n      };\n      this.$store.commit(\"changeToolbarStatus\", toolbarStatus);\n    }\n  },\n  created() {\n    let toolbarStatus = {\n      enter: false,\n      visible: true\n    };\n    this.$store.commit(\"changeToolbarStatus\", toolbarStatus);\n  },\n  mounted() {\n    this.loadNotice();\n\n    // //导航栏显示与颜色\n    // let toolbarStatus = {\n    //   enter: enter,\n    //   visible: top,\n    // };\n    // this.$store.commit(\"changeToolbarStatus\", toolbarStatus);\n  },\n  methods: {\n    loadNotice() {\n      this.$request.get('/notice/selectAll').then(res => {\n        this.notice = res.data;\n        let i = 0;\n        if (this.notice && this.notice.length) {\n          this.top = this.notice[0].content;\n          setInterval(() => {\n            this.top = this.notice[i].content;\n            i++;\n            if (i === this.notice.length) {\n              i = 0;\n            }\n          }, 2500);\n        }\n      });\n    },\n    updateUser() {\n      this.user = JSON.parse(localStorage.getItem('xm-user') || '{}'); // 重新获取下用户的最新信息\n    },\n    // 退出登录\n    logout() {\n      localStorage.removeItem(\"xm-user\");\n      this.$router.push(\"/login\");\n    }\n  }\n};","map":{"version":3,"names":["name","data","top","notice","user","JSON","parse","localStorage","getItem","hoverEnter","toolButton","scrollTop","mobile","computed","toolbar","$store","state","watch","oldScrollTop","enter","window","innerHeight","isShow","$","css","toolbarStatus","visible","commit","created","mounted","loadNotice","methods","$request","get","then","res","i","length","content","setInterval","updateUser","logout","removeItem","$router","push"],"sources":["src/views/Front.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"front-notice\"><i class=\"el-icon-bell\" style=\"margin-right: 2px\"></i>公告：{{ top }}</div>\r\n    <!--头部-->\r\n    <div class=\"front-header toolBar\" v-show=\"toolbar.visible\" @mouseenter=\"hoverEnter = true\"\r\n      @mouseleave=\"hoverEnter = false\"\r\n      :class=\"[{ enter: toolbar.enter }, { hoverEnter: (hoverEnter) && !toolbar.enter }]\">\r\n      <!-- 左边 -->\r\n      <div class=\"front-header-left\">\r\n        <!-- <img src=\"@/assets/imgs/logo.png\" alt=\"\"> -->\r\n        <div class=\"title\">\r\n          <span @click=\"$router.push({ path: '/front/home' })\">Mr Lv's BLOG</span>\r\n        </div>\r\n      </div>\r\n      <!-- 中间 -->\r\n      <div class=\"front-header-center\">\r\n        <div class=\"front-header-nav\">\r\n          <el-menu :default-active=\"$route.path\" mode=\"horizontal\" router>\r\n            <el-menu-item index=\"/front/home\">首页</el-menu-item>\r\n            <!-- <el-menu-item index=\"/front/person\">个人中心</el-menu-item> -->\r\n          </el-menu>\r\n        </div>\r\n      </div>\r\n      <!-- 右边 -->\r\n      <div class=\"front-header-right\">\r\n        <!-- <div v-if=\"!user.username\">\r\n          <el-button @click=\"$router.push('/login')\">登录</el-button>\r\n          <el-button @click=\"$router.push('/register')\">注册</el-button>\r\n        </div> -->\r\n        <div>\r\n          <el-dropdown>\r\n            <div class=\"front-header-dropdown\">\r\n              <img :src=\"user.avatar\" alt=\"\">\r\n              <div style=\"margin-left: 10px\">\r\n                <span>{{ user.name }}</span><i class=\"el-icon-arrow-down\" style=\"margin-left: 5px\"></i>\r\n              </div>\r\n            </div>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <div v-if=\"!user.username\">\r\n                <el-dropdown-item>\r\n                  <div style=\"text-decoration: none\" @click=\"$router.push('/login')\">登录</div>\r\n                </el-dropdown-item>\r\n              </div>\r\n              <div v-else>\r\n                <el-dropdown-item>\r\n                  <div style=\"text-decoration: none\" @click=\"$router.push('/front/person')\">\r\n                    <!-- <i class=\"fa fa-sign-in\" aria-hidden=\"true\"></i> -->\r\n                    <span>个人中心</span>\r\n                  </div>\r\n                </el-dropdown-item>\r\n                <el-dropdown-item>\r\n                  <div style=\"text-decoration: none\" @click=\"logout\">退出</div>\r\n                </el-dropdown-item>\r\n              </div>\r\n\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!--主体-->\r\n    <div class=\"main-body\">\r\n      <router-view ref=\"child\" @update:user=\"updateUser\" />\r\n    </div>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n  name: \"FrontLayout\",\r\n\r\n  data() {\r\n    return {\r\n      top: '',\r\n      notice: [],\r\n      user: JSON.parse(localStorage.getItem(\"xm-user\") || '{}'),\r\n      hoverEnter: false,\r\n      toolButton: false,\r\n      scrollTop: 0,\r\n      mobile: false\r\n    }\r\n  },\r\n  computed: {\r\n    toolbar() {\r\n      return this.$store.state.toolbar;\r\n    },\r\n  },\r\n  watch:{\r\n    scrollTop(scrollTop, oldScrollTop) {\r\n        //如果滑动距离超过屏幕高度三分之一视为进入页面，背景改为白色\r\n        let enter = scrollTop > window.innerHeight / 2;\r\n        const top = scrollTop - oldScrollTop < 0;\r\n        let isShow = scrollTop - window.innerHeight > 30;\r\n        this.toolButton = isShow;\r\n        if (isShow) {\r\n          if (window.innerHeight > 950) {\r\n            $(\".cd-top\").css(\"top\", \"0\");\r\n          } else {\r\n            $(\".cd-top\").css(\"top\", window.innerHeight - 950 + \"px\");\r\n          }\r\n        } else if (!isShow) {\r\n          $(\".cd-top\").css(\"top\", \"-900px\");\r\n        }\r\n\r\n        //导航栏显示与颜色\r\n        let toolbarStatus = {\r\n          enter: enter,\r\n          visible: top,\r\n        };\r\n        this.$store.commit(\"changeToolbarStatus\", toolbarStatus);\r\n      },\r\n  },\r\n  created() {\r\n    let toolbarStatus = {\r\n      enter: false,\r\n      visible: true,\r\n    };\r\n    this.$store.commit(\"changeToolbarStatus\", toolbarStatus);\r\n  },\r\n  mounted() {\r\n    this.loadNotice()\r\n\r\n    // //导航栏显示与颜色\r\n    // let toolbarStatus = {\r\n    //   enter: enter,\r\n    //   visible: top,\r\n    // };\r\n    // this.$store.commit(\"changeToolbarStatus\", toolbarStatus);\r\n  },\r\n  methods: {\r\n    loadNotice() {\r\n      this.$request.get('/notice/selectAll').then(res => {\r\n        this.notice = res.data\r\n        let i = 0\r\n        if (this.notice && this.notice.length) {\r\n          this.top = this.notice[0].content\r\n          setInterval(() => {\r\n            this.top = this.notice[i].content\r\n            i++\r\n            if (i === this.notice.length) {\r\n              i = 0\r\n            }\r\n          }, 2500)\r\n        }\r\n      })\r\n    },\r\n    updateUser() {\r\n      this.user = JSON.parse(localStorage.getItem('xm-user') || '{}')   // 重新获取下用户的最新信息\r\n    },\r\n    // 退出登录\r\n    logout() {\r\n      localStorage.removeItem(\"xm-user\");\r\n      this.$router.push(\"/login\");\r\n    },\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n@import \"@/assets/css/front.css\";\r\n\r\n.toolBar {\r\n  /* 固定位置，不随滚动条滚动 */\r\n  position: fixed;\r\n  z-index: 100;\r\n  /* 禁止选中文字 */\r\n  user-select: none;\r\n  transition: all 0.3s ease-in-out;\r\n}\r\n\r\n.toolbar.enter {\r\n  background: rgba(255, 255, 255, 1);\r\n  color: #333333;\r\n  box-shadow: 0 1px 3px 0 rgba(0, 34, 77, 0.05);\r\n}\r\n\r\n.toolbar.hoverEnter {\r\n  background: rgba(0, 0, 0, 0.5);\r\n  box-shadow: 0 1px 3px 0 rgba(0, 34, 77, 0.05);\r\n}\r\n\r\n.cd-top {\r\n    background: url(../file/top.jpg) no-repeat center;\r\n    position: fixed;\r\n    right: 5vh;\r\n    top: -900px;\r\n    z-index: 99;\r\n    width: 70px;\r\n    height: 900px;\r\n    background-size: contain;\r\n    transition: all 0.5s ease-in-out;\r\n    cursor: pointer;\r\n  }\r\n</style>"],"mappings":";AAsEA;EACAA,IAAA;EAEAC,KAAA;IACA;MACAC,GAAA;MACAC,MAAA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,UAAA;MACAC,UAAA;MACAC,SAAA;MACAC,MAAA;IACA;EACA;EACAC,QAAA;IACAC,QAAA;MACA,YAAAC,MAAA,CAAAC,KAAA,CAAAF,OAAA;IACA;EACA;EACAG,KAAA;IACAN,mBAAA,EAAAO,YAAA;MACA;MACA,IAAAC,KAAA,GAAAR,SAAA,GAAAS,MAAA,CAAAC,WAAA;MACA,MAAAnB,GAAA,GAAAS,SAAA,GAAAO,YAAA;MACA,IAAAI,MAAA,GAAAX,SAAA,GAAAS,MAAA,CAAAC,WAAA;MACA,KAAAX,UAAA,GAAAY,MAAA;MACA,IAAAA,MAAA;QACA,IAAAF,MAAA,CAAAC,WAAA;UACAE,CAAA,YAAAC,GAAA;QACA;UACAD,CAAA,YAAAC,GAAA,QAAAJ,MAAA,CAAAC,WAAA;QACA;MACA,YAAAC,MAAA;QACAC,CAAA,YAAAC,GAAA;MACA;;MAEA;MACA,IAAAC,aAAA;QACAN,KAAA,EAAAA,KAAA;QACAO,OAAA,EAAAxB;MACA;MACA,KAAAa,MAAA,CAAAY,MAAA,wBAAAF,aAAA;IACA;EACA;EACAG,QAAA;IACA,IAAAH,aAAA;MACAN,KAAA;MACAO,OAAA;IACA;IACA,KAAAX,MAAA,CAAAY,MAAA,wBAAAF,aAAA;EACA;EACAI,QAAA;IACA,KAAAC,UAAA;;IAEA;IACA;IACA;IACA;IACA;IACA;EACA;EACAC,OAAA;IACAD,WAAA;MACA,KAAAE,QAAA,CAAAC,GAAA,sBAAAC,IAAA,CAAAC,GAAA;QACA,KAAAhC,MAAA,GAAAgC,GAAA,CAAAlC,IAAA;QACA,IAAAmC,CAAA;QACA,SAAAjC,MAAA,SAAAA,MAAA,CAAAkC,MAAA;UACA,KAAAnC,GAAA,QAAAC,MAAA,IAAAmC,OAAA;UACAC,WAAA;YACA,KAAArC,GAAA,QAAAC,MAAA,CAAAiC,CAAA,EAAAE,OAAA;YACAF,CAAA;YACA,IAAAA,CAAA,UAAAjC,MAAA,CAAAkC,MAAA;cACAD,CAAA;YACA;UACA;QACA;MACA;IACA;IACAI,WAAA;MACA,KAAApC,IAAA,GAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;IACA;IACA;IACAiC,OAAA;MACAlC,YAAA,CAAAmC,UAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;IACA;EACA;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}