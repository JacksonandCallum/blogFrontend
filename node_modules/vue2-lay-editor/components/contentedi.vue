<template>
  <div>
    <div
      id="contentedi"
      ref="contentedi"
      :style="styles"
      class="contentedi"
      contenteditable="true"
      placeholder="è¯·è¾“å…¥..."
      @keyup="onHandler"
      @input="onHandler"
      @mouseup="onHandler"
      @click="onHandler"
    ></div>
  </div>
</template>

<script>
export default {
  name: "contentedi",
  model: {
    prop: "value",
    event: "input",
  },
  props: {
    styles: {
      default() {
        return {};
      },
    },
    value: {
      default: "",
    },
  },
  data() {
    return {
      content: "",
    };
  },
  mounted() {
    // this.$nextTick(() => {
    //   this.$refs.contentedi.innerHTML = this.value;
    //   this.content = this.value;
    //   this.$emit("change", this.content);
    // });
  },
  watch: {
    value: {
      immediate: true,
      handler() {
        if (this.content != this.value) {
          this.$refs.contentedi.innerHTML = this.value;
          this.content = this.value;
          this.$emit("change", this.content);
        }
      },
    },
  },
  methods: {
    onHandler() {
      let content = this.$refs.contentedi.innerHTML;
      this.content = content;
      this.$emit("input", content);
      this.$emit("change", content);
    },
  },
};
</script>

<style>
.contentedi {
  outline: none;
}
.contentedi * {
  overflow: auto;
  word-break: break-all;
  font-family: 16px "Microsoft YaHei", "å®‹ä½“", Tahoma, Arial, sans-serif;
  line-height: 1.75;
  font-size: 16px;
  word-break: break-word;
}
.contentedi ul,
.contentedi ol {
  padding-left: 20px;
}
.contentedi li {
  list-style-type: "ðŸ”¸";
  padding-left: 5px;
}
.contentedi ol li {
  list-style-type: decimal;
}
.contentedi:empty::before {
  content: attr(placeholder);
  color: #c0c4cf;
}
</style>
