<template>
  <div class="link-block">
    <div class="link-block-section">
      <dropdown-select v-model="show">
        <!-- 展示 -->
        <div slot="title">
          <div class="link-block-item">
            <p class="title">
              {{ name }}
            </p>
          </div>
        </div>
        <!-- 操作 -->
        <div>
          <linkbar-content
            :link="link"
            :name="name"
            :autoClear="false"
            @confirm="setLink"
          ></linkbar-content>
        </div>
      </dropdown-select>
    </div>
  </div>
</template>

<script>
import linkbarContent from "../../components/linkbar-content.vue";
import dropdownSelect from "../../components/dropdown-select";

const temp = (name, link) => {
  return `
  <div style="padding:10px 0">
    <div
      style="
        width: 300px;
        padding: 15px;
        border-radius: 5px;
        padding:10px;
        margin:auto;
        background: #f5f5f5;
        cursor: pointer;
      "
      onclick="window.open('${link}')"
      class="link-block-item"
    >${name}</div>
  </div>
   
  `;
};

export default {
  name: "link-block",
  components: {
    linkbarContent,
    dropdownSelect,
  },
  props: {
    content: {
      default() {
        return {};
      },
    },
    token: {
      default: "",
    },
  },
  data() {
    return {
      name: "",
      link: "",
      show: false,
    };
  },
  watch: {
    token: {
      immediate: true,
      handler() {
        this.name = this.content.name;
        this.link = this.content.link;
        this.onChange();
      },
    },
  },
  mounted() {},
  methods: {
    setLink(data) {
      this.link = data.link;
      this.name = data.name;
      this.onChange();
    },
    onChange() {
      this.$emit("change", {
        link: this.link,
        name: this.name,
        template: temp(this.name, this.link),
      });
      this.show = false;
    },
  },
};
</script>

<style lang="scss" scoped>
.link-block {
  padding: 20px 10px;
  // background: #fff;
}
// 内容 区域
.link-block-section {
  display: flex;
  justify-content: center;
}
.link-block-section .link-block-item {
  width: 300px;
  padding: 15px;
  border-radius: 5px;
  margin: auto;
  background: #f5f5f5;
  cursor: pointer;
}
.link-block-section .link-block-item .title {
  margin: 0;
  line-height: 18px;
  font-size: 14px;
  color: #555;
}
</style>
